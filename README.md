
# Phoneme-Based TTS Project

This project is built to train and evaluate a phoneme-based Text-to-Speech (TTS) model using paired audio and phoneme data.

---

## ğŸ“ Code Files and Their Pipelines

### 1. `gruut_phonemizer.py`
- Phonemizes transcripts using `gruut`.
- Converts `.txt` or `.csv` metadata entries into phoneme sequences.
- Outputs `.txt` files with phoneme sequences per audio file.

### 2. `prepare_dataset.py`
- Loads metadata, audio, and phoneme files.
- Validates file existence and duration.
- Converts audio to tensors and stores phoneme sequences.
- Saves dataset as `dataset.pt` for training.

### 3. `train.py`
- Loads `dataset.pt`.
- Defines and trains a TTS model (e.g., NanoSpeech).
- Logs training losses, saves checkpoints and model weights.

### 4. `synthesize.py`
- Loads a trained model and phoneme input.
- Synthesizes speech from phoneme sequences.
- Saves generated audio as `.wav` files.

### 5. `evaluate.py`
- Evaluates generated speech using metrics like:
  - DTW (Dynamic Time Warping)
  - L1/L2 loss
  - KL Divergence
- Compares output with ground truth for validation.

---

## ğŸ§ª Example Usage

```bash
# Step 1: Phonemize the text
python gruut_phonemizer.py

# Step 2: Prepare the dataset
python prepare_dataset.py

# Step 3: Train the model
python train.py

# Step 4: Synthesize audio from phonemes
python synthesize.py

# Step 5: Evaluate model output
python evaluate.py
```

---

## ğŸ› ï¸ Requirements

Install the required Python packages with:

```bash
pip install torch librosa numpy gruut tqdm
```

---

## ğŸ“ Data Directory Structure

```
data/
â”œâ”€â”€ metadata.csv
â”œâ”€â”€ audio_split/       # Contains .wav files
â”œâ”€â”€ phonemes/          # Contains .txt phoneme files
â””â”€â”€ dataset.pt         # Generated by prepare_dataset.py
```

---

## ğŸ‘¤ Author

Developed for phoneme-based TTS research using Desivocal data.
